#!/usr/bin/env python3
# -*- coding: utf-8 -*-

import json
import re
from collections import Counter
from pathlib import Path


OUTPUT_PATH = Path(__file__).resolve().parents[1] / "src" / "data" / "questions" / "arts.json"


def item(question: str, answer: str, subtopic: str, difficulty: str) -> dict:
    # Keep prompt text clean for participants; speed labels stay as metadata, not in question text.
    clean_question = re.sub(r"^سريع(?:\s*-\s*(?:متوسط|صعب))?\s*:\s*", "", question.strip())
    return {
        "question": clean_question,
        "answer": answer.strip(),
        "subtopic": subtopic,
        "difficulty": difficulty,
    }


def extend_bucket(bucket: list, subtopic: str, rows: list[tuple[str, str, str]]) -> None:
    for q, a, d in rows:
        bucket.append(item(q, a, subtopic, d))


questions: list[dict] = []


# ---------------------------------
# 1) سينما ومسرح قبطي (50)
# ---------------------------------
cinema_subtopic = "سينما ومسرح قبطي"

cinema_easy = [
    ("ما الهدف الأساسي من المسرح الكنسي؟", "تقديم رسالة روحية وتربوية تبني الإنسان.", "سهل"),
    ("ما المصدر الأول لنصوص الفيلم القبطي؟", "الكتاب المقدس وسير القديسين.", "سهل"),
    ("من هو كاروز الديار المصرية؟", "القديس مارمرقس الرسول.", "سهل"),
    ("من يُلقب بأبي الرهبان؟", "القديس الأنبا أنطونيوس.", "سهل"),
    ("من هو أول السواح في التراث القبطي؟", "القديس الأنبا بولا.", "سهل"),
    ("من هو الشهيد الملقب بالأمير الشهيد؟", "الشهيد مارجرجس.", "سهل"),
    ("من هو الشهيد المعروف بأبي سيفين؟", "الشهيد مارمرقوريوس.", "سهل"),
    ("أي قديسة ترتبط بسيرة الأربعين عذراء؟", "القديسة دميانة.", "سهل"),
    ("من هو الأسقف المعروف بلقب صديق الفقراء؟", "القديس الأنبا أبرآم.", "سهل"),
    ("أي بابا قبطي اشتهر بحياة الصلاة؟", "البابا كيرلس السادس.", "سهل"),
    ("من المسؤول عن توجيه الممثلين في العمل الدرامي؟", "المخرج.", "سهل"),
    ("ما العنصر الذي ينظم تسلسل المشاهد قبل التصوير؟", "السيناريو.", "سهل"),
    ("ما فائدة البروفة قبل العرض أو التصوير؟", "ضبط الأداء والحركة والتوقيت.", "سهل"),
    ("لماذا تُراجع النصوص قبل تنفيذ عمل كنسي؟", "لمنع الأخطاء العقيدية والتعليمية.", "سهل"),
    ("في العمل الكنسي، أيهما أولوية: الرسالة أم المؤثرات؟", "الرسالة الروحية.", "سهل"),
    ("ما وظيفة الموسيقى الهادئة في مشهد صلاة؟", "إبراز السكون والخشوع.", "سهل"),
    ("ما نوع النهاية الأنسب غالبًا للعمل الكنسي؟", "نهاية تفتح باب الرجاء والتوبة.", "سهل"),
    ("لماذا يُذكر المرجع الكتابي أحيانًا في نهاية مشهد؟", "لربط الرسالة بكلمة الله.", "سهل"),
]

saint_titles = [
    ("القديس مارمرقس الرسول", "كاروز الديار المصرية"),
    ("القديس الأنبا أنطونيوس", "أبو الرهبان"),
    ("القديس الأنبا بولا", "أول السواح"),
    ("الشهيد مارجرجس", "الأمير الشهيد"),
    ("الشهيد مارمرقوريوس", "أبو سيفين"),
    ("القديسة دميانة", "عروس المسيح"),
    ("البابا كيرلس السادس", "رجل الصلاة"),
    ("الأنبا أبرآم", "صديق الفقراء"),
    ("البابا أثناسيوس الرسولي", "حامي الإيمان"),
    ("البابا كيرلس عمود الدين", "عمود الدين"),
    ("القديس الأنبا بيشوي", "حبيب المسيح"),
    ("الشهيد مارمينا", "العجائبي"),
]
for saint, title in saint_titles:
    cinema_easy.append((f"في سيرة القديسين المصوّرة، من يُلقب بـ {title}؟", saint, "سهل"))

cinema_medium = [
    ("ما المقصود بالمونتاج في إنتاج الفيلم الكنسي؟", "ترتيب اللقطات بعد التصوير لصناعة النسخة النهائية.", "متوسط"),
    ("ما الدور الأساسي لمدير الإنتاج؟", "تنظيم الوقت والموارد ومتابعة التنفيذ.", "متوسط"),
    ("ما فائدة الستوري بورد قبل التصوير؟", "تخطيط المشاهد بصريًا قبل التنفيذ.", "متوسط"),
    ("لماذا تساعد الملابس التاريخية في أفلام القديسين؟", "تقرب المشاهد من زمن القصة.", "متوسط"),
    ("كيف يخدم التعليق الصوتي الفيلم التسجيلي الكنسي؟", "يشرح الأحداث ويوضح الرسالة.", "متوسط"),
    ("ما خطر المبالغة في أداء دور قديس؟", "تشويه المعنى الروحي وفقدان الصدق.", "متوسط"),
    ("كيف يمكن إظهار قيمة الغفران دراميًا؟", "بعرض المصالحة بدل الانتقام.", "متوسط"),
    ("ما فائدة تقسيم فريق العمل إلى وحدات واضحة؟", "رفع التنظيم وتقليل الأخطاء.", "متوسط"),
    ("لماذا يستخدم بعض المخرجين إيقاعًا هادئًا في المشاهد التأملية؟", "لإتاحة مساحة للفهم والتأمل.", "متوسط"),
    ("متى تكون الفكاهة مقبولة في العمل الكنسي؟", "عندما تخدم الفكرة باحترام دون إسفاف.", "متوسط"),
    ("ما معيار نجاح عرض مسرحي قبطي؟", "وضوح الرسالة مع انضباط الأداء.", "متوسط"),
    ("كيف تُعرض المعجزة بمسؤولية في الفيلم الكنسي؟", "بدون تهويل ومع ربطها بالإيمان.", "متوسط"),
    ("لماذا قد يُسجل الصوت منفصلًا عن الصورة أحيانًا؟", "للحصول على حوار أنقى وأكثر وضوحًا.", "متوسط"),
    ("ما الخطوة المناسبة للمخرج قبل بدء التصوير؟", "جلسة قراءة وتوجيه للممثلين.", "متوسط"),
    ("ما أولوية كتابة حوار العمل الكنسي؟", "أن يكون واضحًا وصادقًا ومبنيًا روحيًا.", "متوسط"),
]

cinema_hard = [
    ("ما الفرق بين الفيلم الروائي والتسجيلي في الخدمة؟", "الروائي يعتمد الحبكة والتمثيل، والتسجيلي يعتمد الشهادات والوثائق.", "صعب"),
    ("كيف يوازن العمل الكنسي بين الدقة التاريخية والجاذبية الفنية؟", "بالحفاظ على الحقائق مع معالجة درامية منضبطة.", "صعب"),
    ("ما المقصود بقوس الشخصية في دراما التوبة؟", "انتقال الشخصية من السقوط إلى التغيير الحقيقي.", "صعب"),
    ("كيف يُعرض خلاف بين خدام داخل فيلم كنسي دون إساءة؟", "بعرض الخلاف ثم المصالحة بالمحبة والاتضاع.", "صعب"),
    ("ما الضابط الأعلى لأي عمل فني كنسي قبطي؟", "أن يمجد الله ويبني الإنسان والكنيسة.", "صعب"),
]

extend_bucket(questions, cinema_subtopic, cinema_easy + cinema_medium + cinema_hard)


# ---------------------------------
# 2) ترانيم وألحان كنسية (50)
# ---------------------------------
hymns_subtopic = "ترانيم وألحان كنسية"

hymns_easy = [
    ("ما المقصود بالتسبحة في الكنيسة القبطية؟", "صلوات تسبيح كنسية تُرفع لله.", "سهل"),
    ("كم عدد الهوسات الأساسية في التسبحة السنوية؟", "أربعة هوسات.", "سهل"),
    ("الهوس الأول يرتبط بأي حدث كتابي؟", "تسبحة موسى بعد عبور البحر الأحمر.", "سهل"),
    ("الهوس الثالث يذكرنا بمن؟", "فتية أتون بابل.", "سهل"),
    ("الهوس الرابع يركز على ماذا؟", "تسبيح الخليقة كلها لله.", "سهل"),
    ("ما اللغة الأساسية في كثير من الألحان القبطية؟", "اللغة القبطية.", "سهل"),
    ("ما اللغة المستخدمة مع القبطية لخدمة الشعب؟", "اللغة العربية.", "سهل"),
    ("من يقود الشعب في الألحان داخل الكنيسة؟", "المرتل أو معلم الألحان.", "سهل"),
    ("في أي شهر قبطي تشتهر تسابيح العذراء بصورة خاصة؟", "شهر كيهك.", "سهل"),
    ("ما موضوع لحن غولغوثا؟", "آلام وصلب السيد المسيح.", "سهل"),
    ("متى يقال لحن إبؤورو؟", "في عيد القيامة المجيد.", "سهل"),
    ("ما الهدف الروحي من الترانيم؟", "تثبيت الإيمان وتشجيع التوبة والرجاء.", "سهل"),
    ("هل يجوز تغيير كلمات اللحن الطقسي بسهولة؟", "لا، لأنه جزء من التسليم الكنسي.", "سهل"),
    ("من أين يتعلم الشباب الألحان غالبًا؟", "من مدارس الألحان والكنيسة.", "سهل"),
    ("ما فائدة التكرار أثناء تعليم الترنيمة؟", "تثبيت الحفظ وتحسين الأداء.", "سهل"),
    ("ما الأهم في الأداء الكنسي: الصوت أم روح الصلاة؟", "روح الصلاة والفهم أولًا.", "سهل"),
    ("ما الذي يجب مراعاته عند اختيار طبقة الترنيم؟", "أن تناسب أصوات المجموعة.", "سهل"),
    ("ما الهدف النهائي من كل تسبيح قبطي؟", "تمجيد الله وبنيان النفس.", "سهل"),
    ("لماذا يُشرح معنى الكلمات قبل التسبيح؟", "لكي يكون التسبيح بوعي.", "سهل"),
    ("ما فائدة الالتزام بإيقاع موحد في الكورال؟", "تحقيق الانسجام والوضوح.", "سهل"),
]

hymn_terms = [
    ("الإبصالية", "مديح شعري روحي يُرتل في التسبحة"),
    ("الثيؤطوكية", "تمجيد خاص بالقديسة مريم والدة الإله"),
    ("الدكسولوجية", "تمجيد للقديسين"),
    ("المرد", "رد قصير يردده الشعب"),
    ("الإبصلمودية", "كتاب التسبحة السنوية"),
    ("لحن سنوي", "لحن يُستخدم في أغلب أيام السنة"),
    ("لحن صيامي", "لحن يُستخدم في مواسم الصوم"),
    ("لحن فرايحي", "لحن الأعياد المفرحة"),
    ("آدام", "أحد الطابعين الرئيسيين في الألحان القبطية"),
    ("واطس", "الطابع اللحني الآخر في التقليد القبطي"),
]
for term, meaning in hymn_terms:
    hymns_easy.append((f"في الطقس القبطي، ما المقصود بـ {term}؟", meaning + ".", "سهل"))

hymns_medium = [
    ("لماذا يهم النطق القبطي الصحيح أثناء الترتيل؟", "للحفاظ على المعنى والدقة.", "متوسط"),
    ("لماذا يراجع الخادم مصادر معتمدة قبل تعليم لحن؟", "لتجنب نقل أخطاء لحنية أو نصية.", "متوسط"),
    ("كيف تخدم الترانيم اجتماع الشباب؟", "تجعل التعليم أسهل بالحفظ والترديد.", "متوسط"),
    ("ما خطر تحويل فقرة الترنيم إلى استعراض؟", "فقدان روح الصلاة والاتضاع.", "متوسط"),
    ("لماذا يحتاج الكورال إلى قائد واضح؟", "لتوحيد البداية والإيقاع والوقفات.", "متوسط"),
    ("ما أفضل أسلوب لتعليم لحن صعب؟", "تقسيمه إلى جمل قصيرة متدرجة.", "متوسط"),
    ("ما دور الصمت القصير بين المقاطع اللحنية؟", "تهيئة النفس للتأمل والانتباه.", "متوسط"),
    ("ما معيار نجاح فقرة ترانيم في المسابقة؟", "وضوح الكلمات وضبط اللحن وروح الصلاة.", "متوسط"),
    ("كيف يُقيَّم حفظ اللحن عند المتسابق؟", "بدقة النغم والإيقاع والنطق.", "متوسط"),
    ("ما فائدة توحيد طبقة الأداء داخل الكورال؟", "تقليل النشاز وتحسين الانسجام.", "متوسط"),
    ("ما العلاقة بين الألحان والعقيدة؟", "الألحان تعبّر عن الإيمان الكنسي وتحفظه.", "متوسط"),
    ("لماذا تُعد الأمانة للتسليم مهمة في خدمة الألحان؟", "لضمان نقل التراث بصورة صحيحة.", "متوسط"),
    ("ما الذي يسبق تدريب لحن جديد في فريق الخدمة؟", "شرح النص والمعنى الروحي أولًا.", "متوسط"),
    ("كيف تساعد الترانيم في تثبيت آيات الكتاب المقدس؟", "بالربط بين الكلمات واللحن في الذاكرة.", "متوسط"),
    ("ما الضابط عند استخدام آلة موسيقية في التدريب؟", "أن تخدم روح الصلاة ولا تطغى على الكلمات.", "متوسط"),
]

hymns_hard = [
    ("ما الفرق بين التعليم السمعي والتعليم بالنوتة في الألحان؟", "السمعي ينقل التسليم العملي، والنوتة توثق وتساعد على المراجعة.", "صعب"),
    ("كيف يوازن خادم الألحان بين الأمانة للتسليم والتبسيط للمبتدئين؟", "يحافظ على الأصل ويشرح تدريجيًا دون تشويه.", "صعب"),
    ("لماذا تعد الألحان القبطية جزءًا من الهوية الكنسية لا مجرد فن؟", "لارتباطها بالعبادة والعقيدة والتاريخ الكنسي.", "صعب"),
    ("كيف نحافظ على نصوص التسبحة عبر الأجيال؟", "بالمراجعة من مصادر معتمدة والتعليم المنظم.", "صعب"),
    ("ما معنى أن يكون التسبيح بالروح والحق في الخدمة؟", "أن يجتمع الفهم القلبي مع الأمانة للنص الكنسي.", "صعب"),
]

extend_bucket(questions, hymns_subtopic, hymns_easy + hymns_medium + hymns_hard)


# ---------------------------------
# 3) أيقونات وفنون قبطية (50)
# ---------------------------------
icons_subtopic = "أيقونات وفنون قبطية"

icons_easy = [
    ("ما هي الأيقونة في الكنيسة القبطية؟", "صورة مقدسة للتعليم والتذكار الروحي.", "سهل"),
    ("هل تُعبد الأيقونة في الكنيسة؟", "لا، الإكرام يُقدَّم للمرسوم لا للمادة.", "سهل"),
    ("أين توضع الأيقونات غالبًا داخل الكنيسة؟", "على حامل الأيقونات وجدران الكنيسة.", "سهل"),
    ("ما اسم الحاجز الذي يحمل الأيقونات بين الهيكل وصحن الكنيسة؟", "الأيقونستاس (حامل الأيقونات).", "سهل"),
    ("ماذا ترمز الهالة حول رأس القديس؟", "القداسة والنور الروحي.", "سهل"),
    ("لماذا تُرسم العيون واسعة غالبًا في الأيقونة القبطية؟", "للدلالة على البصيرة الروحية.", "سهل"),
    ("لماذا يكون الفم صغيرًا في كثير من الأيقونات؟", "رمزًا لضبط اللسان.", "سهل"),
    ("ما دلالة إبراز الأذن في الأيقونة؟", "الإصغاء لكلمة الله.", "سهل"),
    ("ما الخامة الشائعة لسطح الأيقونة التقليدية؟", "الخشب.", "سهل"),
    ("من أبرز مجددي الأيقونة القبطية الحديثة؟", "الدكتور إسحق فانوس.", "سهل"),
    ("ما الموضوع الأكثر حضورًا في الأيقونات القبطية؟", "السيد المسيح والعذراء والقديسون.", "سهل"),
    ("أيقونة العشاء الأخير ترتبط بأي سر؟", "سر الإفخارستيا.", "سهل"),
    ("لماذا تُكتب أسماء القديسين على الأيقونات؟", "لتحديد الشخصية ومنع الالتباس.", "سهل"),
    ("ما الهدف من وجود الأيقونات في فصول مدارس الأحد؟", "التعليم البصري السريع وترسيخ القصص الروحية.", "سهل"),
    ("ما السلوك اللائق أمام الأيقونة؟", "الوقار والاحترام.", "سهل"),
    ("ماذا تعلن أيقونة القيامة؟", "انتصار المسيح على الموت.", "سهل"),
    ("بماذا تذكّر أيقونة الصلبوت؟", "بفداء السيد المسيح على الصليب.", "سهل"),
    ("ما أهمية الألوان في الأيقونة؟", "تحمل دلالات روحية ورمزية.", "سهل"),
]

icon_colors = [
    ("الذهبي", "المجد السماوي"),
    ("الأبيض", "النقاوة والقيامة"),
    ("الأحمر", "المحبة والبذل"),
    ("الأزرق", "السمو والبعد السماوي"),
    ("الأخضر", "الحياة والرجاء"),
]
for color, meaning in icon_colors:
    icons_easy.append((f"في الأيقونة القبطية، ماذا يرمز اللون {color} غالبًا؟", meaning + ".", "سهل"))

icon_events = [
    ("البشارة", "بشارة الملاك للعذراء مريم"),
    ("الميلاد", "ميلاد السيد المسيح"),
    ("الغطاس", "عماد السيد المسيح في الأردن"),
    ("أحد الشعانين", "دخول السيد المسيح أورشليم"),
    ("الصلب", "فداء المسيح على الصليب"),
    ("القيامة", "انتصار المسيح على الموت"),
    ("الصعود", "صعود السيد المسيح إلى السماء"),
]
for feast, event in icon_events:
    icons_easy.append((f"أي حدث تعبّر عنه أيقونة {feast}؟", event + ".", "سهل"))

icons_medium = [
    ("لماذا يهم توحيد الطراز الفني داخل الكنيسة؟", "للحفاظ على الهوية البصرية القبطية.", "متوسط"),
    ("لماذا تُعتمد أيقونات الكنيسة من جهة كنسية مختصة؟", "لضبط الدقة العقيدية والفنية.", "متوسط"),
    ("ما المقصود بالقراءة البصرية للأيقونة؟", "فهم الرموز والألوان وتعبيرات المشهد.", "متوسط"),
    ("كيف تساعد الأيقونة في حفظ سير الشهداء؟", "تربط الاسم بالمشهد والفضيلة.", "متوسط"),
    ("ما العلاقة بين الأيقونة والليتورجيا؟", "الأيقونة ترافق الصلاة وتدعم التأمل.", "متوسط"),
    ("لماذا تفضّل الكنيسة الفن المحتشم في الأيقونة؟", "لأن الهدف روحي لا استعراضي.", "متوسط"),
    ("ما أثر الإضاءة المناسبة على عرض الأيقونة؟", "تُظهر التفاصيل وتحافظ على الوقار.", "متوسط"),
    ("ما فائدة توثيق اسم الرسام وتاريخ الأيقونة؟", "حفظ التراث وسهولة المراجعة.", "متوسط"),
    ("كيف يخدم ترميم الأيقونات حياة الكنيسة؟", "يحافظ على الذاكرة الكنسية للأجيال.", "متوسط"),
    ("ما الضابط عند استخدام صور رقمية للأيقونات؟", "الحفاظ على الدقة وعدم التحريف.", "متوسط"),
    ("ما خطر خلط رموز عقائدية متناقضة في لوحة واحدة؟", "تشويه التعليم الكنسي.", "متوسط"),
    ("ما قيمة الفن القبطي للخادم الشاب؟", "يربطه بتاريخ الكنيسة وهويتها.", "متوسط"),
    ("كيف تُصمم مسابقة أيقونات تعليمية ناجحة؟", "صورة واضحة وسؤال محدد وإجابة موثقة.", "متوسط"),
    ("ما معيار جودة سؤال الأيقونات في بنك الأسئلة؟", "الدقة اللاهوتية مع البساطة.", "متوسط"),
    ("ما الفرق العملي بين الأيقونة واللوحة الديكورية؟", "الأيقونة تخدم التعليم والعبادة، لا الزينة فقط.", "متوسط"),
]

icons_hard = [
    ("ما الفرق بين الرمز والتشخيص في الأيقونة القبطية؟", "الرمز يوجّه لمعنى روحي، والتشخيص يصف الشكل الخارجي.", "صعب"),
    ("لماذا تُوصف الأيقونة بأنها لاهوت مرسوم؟", "لأنها تنقل الإيمان بصيغة بصرية.", "صعب"),
    ("كيف يوازن الفنان القبطي بين الأصالة والتجديد؟", "يحافظ على القواعد الكنسية ويبتكر داخل إطارها.", "صعب"),
    ("ما خطر الاعتماد على صور مجهولة المصدر في التعليم الكنسي؟", "نقل رموز أو معلومات غير دقيقة.", "صعب"),
    ("ما الهدف النهائي من الفن القبطي الأصيل؟", "إعلان الإنجيل وبنيان الإنسان الداخلي.", "صعب"),
]

extend_bucket(questions, icons_subtopic, icons_easy + icons_medium + icons_hard)


# ---------------------------------
# 4) سرعة بديهة فنية (50)
# ---------------------------------
speed_subtopic = "سرعة بديهة فنية"

speed_easy = [
    ("سريع: ما الهدف المختصر من الفن الكنسي؟", "تمجيد الله وبنيان النفس.", "سهل"),
    ("سريع: كاروز الديار المصرية هو من؟", "القديس مارمرقس الرسول.", "سهل"),
    ("سريع: من هو أبو الرهبان؟", "القديس الأنبا أنطونيوس.", "سهل"),
    ("سريع: من هو أول السواح؟", "القديس الأنبا بولا.", "سهل"),
    ("سريع: من هو الأمير الشهيد؟", "الشهيد مارجرجس.", "سهل"),
    ("سريع: من هو أبو سيفين؟", "الشهيد مارمرقوريوس.", "سهل"),
    ("سريع: ما شهر التسابيح المريمية المميزة؟", "كيهك.", "سهل"),
    ("سريع: كم عدد الهوسات في التسبحة؟", "أربعة.", "سهل"),
    ("سريع: ما كتاب التسبحة الأساسي؟", "الإبصلمودية.", "سهل"),
    ("سريع: ماذا يسمى تمجيد العذراء في التسبحة؟", "الثيؤطوكية.", "سهل"),
    ("سريع: ماذا يسمى تمجيد القديسين؟", "الدكسولوجية.", "سهل"),
    ("سريع: ما اسم الرد القصير للشعب؟", "المرد.", "سهل"),
    ("سريع: ما اللغة التراثية للألحان القبطية؟", "القبطية.", "سهل"),
    ("سريع: ما اسم حامل الأيقونات؟", "الأيقونستاس.", "سهل"),
    ("سريع: ماذا تسمى الدائرة حول رأس القديس؟", "الهالة.", "سهل"),
    ("سريع: من أشهر مجددي الأيقونة القبطية الحديثة؟", "الدكتور إسحق فانوس.", "سهل"),
    ("سريع: ماذا يرمز اللون الذهبي في الأيقونات؟", "المجد السماوي.", "سهل"),
    ("سريع: بأي سر ترتبط أيقونة العشاء الأخير؟", "سر الإفخارستيا.", "سهل"),
    ("سريع: من يوجه الممثلين داخل العمل الفني؟", "المخرج.", "سهل"),
    ("سريع: ما اسم مرحلة ترتيب اللقطات؟", "المونتاج.", "سهل"),
]

quick_titles = [
    ("رجل الصلاة", "البابا كيرلس السادس"),
    ("صديق الفقراء", "الأنبا أبرآم"),
    ("حامي الإيمان", "البابا أثناسيوس الرسولي"),
    ("عمود الدين", "البابا كيرلس عمود الدين"),
    ("العجائبي", "الشهيد مارمينا"),
    ("عروس المسيح", "القديسة دميانة"),
    ("حبيب المسيح", "القديس الأنبا بيشوي"),
    ("الأمير الشهيد", "الشهيد مارجرجس"),
    ("كاروز الديار المصرية", "القديس مارمرقس الرسول"),
    ("أول السواح", "القديس الأنبا بولا"),
]
for title, saint in quick_titles:
    speed_easy.append((f"سريع: لقب {title} يعود إلى من؟", saint + ".", "سهل"))

speed_medium = [
    ("سريع - متوسط: ما الفرق العام بين الترنيمة واللحن الطقسي؟", "الترنيمة نص حديث غالبًا، واللحن الطقسي تسليم عبادي موروث.", "متوسط"),
    ("سريع - متوسط: لماذا لا تُعامل الأيقونة كقطعة ديكور فقط؟", "لأنها وسيلة تعليم وذاكرة روحية.", "متوسط"),
    ("سريع - متوسط: ما أفضل طريقة لحفظ لحن طويل؟", "تقسيمه إلى جمل قصيرة متدرجة.", "متوسط"),
    ("سريع - متوسط: لماذا يستخدم الفن الكنسي القصة؟", "لتثبيت المعنى في الذاكرة.", "متوسط"),
    ("سريع - متوسط: ما الخطر من سؤال فني غير موثق؟", "نشر معلومات خاطئة.", "متوسط"),
    ("سريع - متوسط: لماذا تكون بعض المشاهد الروحية بإيقاع هادئ؟", "لتعميق التأمل.", "متوسط"),
    ("سريع - متوسط: ما دور الموسيقى الهادئة في مشهد صلاة؟", "تعزيز السكون والخشوع.", "متوسط"),
    ("سريع - متوسط: لماذا يفضَّل توحيد زي الكورال في المسابقة؟", "لإظهار الانضباط وتقليل التشتيت.", "متوسط"),
    ("سريع - متوسط: كيف تُقيَّم إجابة فنية صحيحة بسرعة؟", "بدقة المعنى ووضوح الصياغة.", "متوسط"),
    ("سريع - متوسط: إذا تعارض الجمال مع العقيدة في عمل كنسي، ما الأولوية؟", "سلامة العقيدة.", "متوسط"),
    ("سريع - متوسط: ما فائدة ذكر المرجع الكتابي بعد مشهد درامي؟", "توثيق الرسالة كتابيًا.", "متوسط"),
    ("سريع - متوسط: لماذا تُعد الأيقونة لغة بصرية للشعب؟", "لأنها تنقل التعليم بسرعة.", "متوسط"),
    ("سريع - متوسط: كيف تظهر دراما القديس قيمة الثبات؟", "بقرارات إيمانية واضحة تحت الضغط.", "متوسط"),
    ("سريع - متوسط: ما أهم عنصر في فقرة سرعة البديهة؟", "التركيز والانتباه.", "متوسط"),
    ("سريع - متوسط: كيف يتجنب الفريق الإطالة المملة في العرض؟", "بالتركيز على الفكرة الرئيسية.", "متوسط"),
]

speed_hard = [
    ("سريع - صعب: ما المقصود بالهوية البصرية القبطية في عمل فني؟", "رموز وألوان وطراز يعكس التراث القبطي.", "صعب"),
    ("سريع - صعب: كيف تضمن أن سؤال الفن يقيس الفهم لا الحفظ الأعمى؟", "يربط المعلومة بالمعنى والتطبيق.", "صعب"),
    ("سريع - صعب: لماذا يحتاج قائد الفقرة الفنية إعدادًا روحيًا قبل التقني؟", "لأن الخدمة رسالة قبل الأداء.", "صعب"),
    ("سريع - صعب: ما المعيار الأعلى للحكم على منتج فني كنسي؟", "هل يقود إلى المسيح ويبني النفوس.", "صعب"),
    ("سريع - صعب: كيف يتحول الفن في الكنيسة من ترفيه إلى خدمة؟", "عندما يرتبط بالتعليم والتوبة والمحبة.", "صعب"),
]

extend_bucket(questions, speed_subtopic, speed_easy + speed_medium + speed_hard)


# ---------------------------------
# Validation
# ---------------------------------
if len(questions) != 200:
    raise ValueError(f"Expected 200 questions, got {len(questions)}")

difficulty_counts = Counter(q["difficulty"] for q in questions)
expected_difficulty = {"سهل": 120, "متوسط": 60, "صعب": 20}
if dict(difficulty_counts) != expected_difficulty:
    raise ValueError(f"Difficulty distribution mismatch: {difficulty_counts}")

subtopic_counts = Counter(q["subtopic"] for q in questions)
expected_subtopics = {
    "سينما ومسرح قبطي": 50,
    "ترانيم وألحان كنسية": 50,
    "أيقونات وفنون قبطية": 50,
    "سرعة بديهة فنية": 50,
}
if dict(subtopic_counts) != expected_subtopics:
    raise ValueError(f"Subtopic distribution mismatch: {subtopic_counts}")

unique_questions = {q["question"] for q in questions}
if len(unique_questions) != len(questions):
    question_counter = Counter(q["question"] for q in questions)
    duplicates = [q for q, count in question_counter.items() if count > 1]
    sample = duplicates[:10]
    raise ValueError(f"Duplicate question text found. Sample: {sample}")

payload = {
    "id": "arts",
    "title": "الفنون",
    "description": "200 سؤال في الفنون بالمحتوى المسيحي القبطي فقط (سينما ومسرح قبطي، ترانيم وألحان كنسية، أيقونات وفنون قبطية، سرعة بديهة فنية).",
    "questions": questions,
}

OUTPUT_PATH.write_text(json.dumps(payload, ensure_ascii=False, indent=2), encoding="utf-8")

print("Generated:", OUTPUT_PATH)
print("Total questions:", len(questions))
print("Difficulty:", dict(difficulty_counts))
print("Subtopics:", dict(subtopic_counts))
